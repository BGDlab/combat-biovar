---
title: "hbm_paper_results"
output: html_document
date: '2023-11-12'
---

Rmd to show and get feedback on planned for results & figures for the combatLS paper. Currently thinking I'll have centile score results be the focus of the paper and keep z-scores for the supplement.

# Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
if(!require('pacman')) {
  install.packages('pacman')
}
pacman::p_load(data.table, ggplot2, tidyverse, ggseg, ggsegExtra, paletteer, ggpubr, gridExtra, lemon, parallel, rstatix, lme4, interactions, ggrepel, ggrain, skimr)
#Sys.setenv("MC_CORES"=10L)
options("mc.cores")

source("./cubic_scripts/R_scripts/gamlss_helper_funs.R")
source("./cubic_scripts/R_scripts/ranked_welch_tests.R")
aseg_cerebrum <- readRDS(file="/Users/megardn/Desktop/BGD_Repos/ggseg_atlas/aseg_cerebrum_atlas.RDS")

der_path <- "/Users/megardn/Desktop/BGD_Repos/combat_biovar/derivatives/lifespan"

```

#Load

Combat-GAM Centiles

```{r}
gam_centile_df <- fread(file=paste0(der_path, "/cf.gam-batch.study_predictions.csv"))
dim(gam_centile_df)
```

Combat-LS Centiles
```{r}
gamlss_centile_df <- fread(file=paste0(der_path, "/cf.gamlss-batch.study_predictions.csv"))
dim(gamlss_centile_df)
```

Deltas

```{r}
deltas_df <- fread(file=paste0(der_path, "/batch.study_pred_deltas.csv"))
# skimr::skim(deltas_df)
```

Visualize

```{r}
ggplot(deltas_df, aes(x=age_days, y=delta.sGMV, color=sex)) +
  geom_point() +
  geom_smooth()

tidy(lm(delta.sGMV ~ sexMale*age_days, data=deltas_df))
```
