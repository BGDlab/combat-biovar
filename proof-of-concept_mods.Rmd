---
title: "proof-of-concept_mods"
output: html_document
date: '2023-10-06'
---

## Setup

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)
if(!require('pacman')) {
  install.packages('pacman')
}
pacman::p_load(gamlss, gamlss.cens, gamlss.dist, gamlss.mx, gamlss.tr, ggplot2, tidyverse, ggpubr, skimr, gamlss.data, data.table, nlme, devtools, slider)

source("./R_scripts/gamlss_helper_funs.R")
```

## Load Data

```{r}
ukb_df_totals <- read_csv(file="data/ukb_CN_data.csv")
ukb_df_age.filt <- read_csv(file="data/ukb_CN_data_agefilt.csv")
```

Designate *basic* model formula

```{r}
basic.m1 <- gamlss(formula = GMV ~ poly(age_days, 3) + sex,
                       sigma.formula = ~ poly(age_days, 3) + sex,
                       nu.formula = ~ 1,
                       family = BCCG, data=ukb_df_age.filt, trace = FALSE)
```

plot

```{r}
plot_singlestudy_centiles(basic.m1, "GMV", ukb_df_age.filt, "sex")
```

Check sex's significance in variance

```{r}
drop1(basic.m1, what="sigma", scope = "sex")
```


